<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/Layout.xhtml">

	<ui:define name="content">
		<section class="r42-pagina">


			<!-- execução inicial-->
			<f:metadata>
				<f:viewAction action="#{controleEstoque.listarPeriodosInv}" />
			</f:metadata>


			<h:form id="frm">

				<!-- Mensagem form -->
				<p:growl id="msg-frm" showDetail="true" autoUpdate="true" />


				<!-- ************************ -->
				<!-- ************************ -->
				<!-- ************************ -->
				<!-- Dialogo Lista Inventário -->
				<!-- ************************ -->
				<!-- ************************ -->
				<!-- ************************ -->
				<p:dialog styleClass="r42-dialogo5" header="Periodo Inventário"
					widgetVar="wgListaPInv" id="dialogoListaPInv" modal="true"
					resizable="false" responsive="true"
					closable="false">

					<!-- Barra de Ferramentas dialogo-->
					<p:defaultCommand target="bto-none" scope="dialogoListaPInv" />
					<!-- botão default desativa <ENTER> -->
					<p:toolbar>
						<p:toolbarGroup align="left">

							<p:commandButton id="bto-none" style="display:none"
								process="dialogoListaPInv" />

							<p:link
								class="fa fa-home ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only r42-linkButton"
								outcome="Inicio.xhtml">
							</p:link>

							<p:commandButton id="bto-novo" title="Novo" icon="fa fa-file"
								actionListener="#{controleEstoque.novoPeriodo}"
								process="dialogoListaPInv" update="dialogoPeriodoInv"
								oncomplete="PF('wgPeriodoInventario').show()">
								<p:resetInput target="dialogoPeriodoInv" />
							</p:commandButton>

						</p:toolbarGroup>
					</p:toolbar>

					<!-- Listagem periodo inventário -->
					<p:dataTable value="#{controleEstoque.listaEstoqueHdr}"
						rowIndexVar="rowId" var="estoqueHeader" id="tabela" reflow="true"
						rows="12" paginator="true" paginatorPosition="top"
						emptyMessage="Sem periodo de inventário">


						<!-- Colunas -->
						<p:column headerText="#" width="40">
							<p:commandButton icon="fa fa-reply" title="Selecionar"
								action="#{controleEstoque.selecionaPeriodo(estoqueHeader)}"
								process="@this" />
						</p:column>

						<p:column headerText="Data Inicio" width="90">
							<h:outputText value="#{estoqueHeader.dataInicio}">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy" />
							</h:outputText>
						</p:column>

						<p:column headerText="Data Final" width="90">
							<h:outputText value="#{estoqueHeader.dataFinal}">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy" />
							</h:outputText>
						</p:column>

						<p:column headerText="Ação">

							<p:commandButton icon="fa fa-trash" title="Remover"
								action="#{controleEstoque.removerPeriodo(estoqueHeader)}"
								process="@this" update="tabela"
								rendered="#{rowId == controleEstoque.ultimoPeriodo}"
								disabled="#{estoqueHeader.fechado}" />


							<p:commandButton icon="fa fa-lock" title="Fechar"
								action="#{controleEstoque.fechaPeriodo(estoqueHeader)}"
								process="@this" update="tabela"
								rendered="#{!estoqueHeader.fechado}"
								disabled="#{rowId != (controleEstoque.primeiroFechado-1)}" />

							<p:commandButton icon="fa fa-unlock" title="Abrir"
								action="#{controleEstoque.abrePeriodo(estoqueHeader)}"
								process="@this" update="tabela"
								rendered="#{estoqueHeader.fechado}"
								disabled="#{rowId != controleEstoque.primeiroFechado}" />
						</p:column>

					</p:dataTable>
				</p:dialog>

				<!-- ************************** -->
				<!-- ************************** -->
				<!-- ************************** -->
				<!-- Dialogo Periodo Inventário -->
				<!-- ************************** -->
				<!-- ************************** -->
				<!-- ************************** -->
				<p:dialog styleClass="r42-dialogo4" header="Dados Inventário"
					widgetVar="wgPeriodoInventario" id="dialogoPeriodoInv" modal="true"
					resizable="false" responsive="true">

					<p:defaultCommand target="btoPer-ok" scope="dialogoPeriodoInv" />

					<p:panelGrid id="panelPeriodo" columns="2" layout="grid"
						styleClass="panelgrid-noborder r42-panelgrid"
						columnClasses="ui-grid-col-3, ui-grid-col-9">

						<p:outputLabel value="Data Inicial" for="dataInicial" />
						<p:calendar id="dataInicial" size="10" locale="pt_BR"
							value="#{controleEstoque.estoqueHrdEdicao.dataInicio}"
							pattern="dd/MM/yyyy" mask="99/99/9999" showOn="button"
							required="true"
							disabled="#{!controleEstoque.estoqueHrdEdicao.abertura}" />

						<p:outputLabel value="Data Final" for="dataFinal" />
						<p:calendar id="dataFinal" size="10" locale="pt_BR"
							value="#{controleEstoque.estoqueHrdEdicao.dataFinal}"
							pattern="dd/MM/yyyy" mask="99/99/9999" showOn="button"
							required="true" />

						<p:commandButton id="btoPer-ok" title="Ok" icon="fa fa-check"
							actionListener="#{controleEstoque.adicionaPeriodo}"
							process="dialogoPeriodoInv" update="tabela" />

					</p:panelGrid>
				</p:dialog>


			</h:form>
		</section>
	</ui:define>
</ui:composition>